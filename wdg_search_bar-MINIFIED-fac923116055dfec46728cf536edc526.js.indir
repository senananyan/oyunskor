SpilGames(["SWP","SWPUtils","Net","DOMEvent"],function(l,b,t,c){l.init("search_bar");var f=window.document,p=f.body,h=f.getElementById("wdg_search_bar"),u=f.getElementById("search-bar-open"),v=f.getElementById("search-bar-overlay"),w=f.getElementById("search-bar-close"),x=l.getProperty("microservice_url"),y=l.getProperty("url_prefix"),z=l.getProperty("view"),r=function(){var a={};return{set:function(A,b){a[A]=b},get:function(b){return a[b]||!1}}}(),k=function(a,b){b=b||h;return b.querySelector(a)},
g=k("#search-term"),e=k(".search-suggestions"),q=k(".labels"),m=k("ul",q),B=f.getElementById("categories-search-template").innerHTML.replace("data-src","src");q=k(".games");var n=k("ul",q),C=f.getElementById("games-search-template").innerHTML.replace("data-src","src"),d=-1;e&&(showSuggestions=function(){b.addClass(e,"visible")},hideSuggestions=function(){b.removeClass(e,"visible")},emptyList=function(){m.innerHTML="";n.innerHTML="";hideSuggestions()},validateSearchTerm=function(a){return 2<=a.length&&
g.placeholder!==a&&!~a.indexOf("@")},fetchSearchSuggestions=function(a){var c=a.q,d=r.get(c);d?showSuggestionList({searchTerm:c,data:d}):(a.output_format="snippet",t.send({url:x,data:a,onsuccess:function(a){r.set(c,a);showSuggestionList({searchTerm:c,data:a})},onerror:function(a){b.error(a)}},function(){}))},getSearchSuggestions=function(){var a=g.value;a=20<a.length?a.substring(0,20):a;2<=a.length?fetchSearchSuggestions({q:encodeURIComponent(a)}):emptyList()},showSuggestionList=function(a){a=JSON.parse(a.data);
var c=function(a,b){return a.replace(/{(.*?)}/g,function(a,c){return"url"==c&&b.gid?"blank"==b.integration&&b.gameobject?b.gameobject:y+b[c]:"external"==c?"blank"==b.integration?"_blank":"_self":b[c]})},d=function(a,b){return a.map(function(a){return c(b,a)}).join("")};emptyList();m.innerHTML=d(a.suggestions.label.slice(0,3),B);n.innerHTML=d(a.suggestions.game.slice(0,5),C);""===m.innerHTML&&""===n.innerHTML||showSuggestions();""!==m.innerHTML?b.addClass(e,"has-labels"):b.removeClass(e,"has-labels");
""!==n.innerHTML?b.addClass(e,"has-games"):b.removeClass(e,"has-games")},logSearchTerm=function(a){a=a.substr(0,1E3);SpilGames("tracker.event.express",{data:{eventCategory:"search",eventAction:"application",eventLabel:"submit",properties:{searchTerm:a}}})},c.add(h,"submit",function(a){var b=g.value;logSearchTerm(b);0<=d?(c.preventDefault(a),a=e.querySelectorAll("li")[d].querySelector("a"),window.location=a.href):validateSearchTerm(b)?l.System.emit("user.search.request",{searchTerm:b}):c.preventDefault(a)}),
c.add(g,"keyup",function(a){38!==a.keyCode&&40!==a.keyCode&&getSearchSuggestions()}),c.add(g,"keydown",function(a){switch(a.keyCode){case 38:c.preventDefault(a);a=e.querySelectorAll("li");b.removeClass(a[d],"is-selected");d=0<d?--d:a.length-1;b.addClass(a[d],"is-selected");break;case 40:c.preventDefault(a);a=e.querySelectorAll("li");b.removeClass(a[d],"is-selected");d=++d%a.length;b.addClass(a[d],"is-selected");break;case 13:break;default:d=-1}}),c.add(g,"focus",function(){getSearchSuggestions()}),
"desktop"==z&&c.add(f,"click",function(a){h.contains(a.target)||emptyList()}),c.add(u,"click",function(){b.addClass(h,"visible");b.addClass(p,"no-scroll--small");g.focus()}),c.add(w,"click",function(){b.removeClass(h,"visible");b.removeClass(p,"no-scroll--small");emptyList()}),c.add(v,"click",function(){b.removeClass(h,"visible");b.removeClass(p,"no-scroll--small")}))});
//# sourceMappingURL=wdg_search_bar-MINIFIED-fac923116055dfec46728cf536edc526.js.map
