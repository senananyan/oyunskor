SpilGames("SWP Utils DOMSelect Cache DOMEvent BeLazy Cookie Net ThumbnailTracker".split(" "),function(d,e,m,k,I,n,r,t,B){d.init("recent_played_games_menu");var u=window.document,c=d.getProperty("*"),g=u.getElementById("wdg_recent_played_games_menu"),v=c.global_user_id,w=c.siteid,x=d.get("spilgames.module.spapi.backend"),l="recent.played.games."+c.global_user_id,h=function(a,b){k.getItem("backend"===a?l:"recent.played.games",function(a){b(e.isArray(a)?a:[])})},p=function(a,b){k.setItem({key:"backend"===
a?l:"recent.played.games",value:b.slice(0,c.games_limit_client_storage),expires:15552E3})},D=function(a){k.getItem(l+".synced",function(b){a(e.isBoolean(b)?b:!1)})},q=function(a){k.setItem({key:l+".synced",value:!0===a,expires:2592E3})},E=function(a){var b={url:x+"v1/recently-played/"+w+"/"+v+"/"+a,type:"PUT",dataType:"text",data:"",headers:{"x-auth-token":r.getItem("token")}};y("backend",a,!0);t.send(b,function(a){a.isError&&q(!1)})},F=function(a){var b=[];a.forEach(function(a){b.push({id:a,date:0})});
a={url:x+"v1/recently-played/"+w+"/"+v,type:"POST",dataType:"json",data:JSON.stringify({items:b.slice(0,c.games_limit_authenticated)}),headers:{"x-auth-token":r.getItem("token")}};t.send(a,function(a){a.isError?q(!1):q(!0)})},y=function(a,b,C){a=a||c.storage_endpoint;b=b||c.app_id;"backend"!==a||C?h(a,function(f){var c=f.indexOf(b);-1<c&&f.splice(c,1);f.unshift(b);p(a,f)}):E(b)},H=function(){var a=d.getProperty("wdg_id");a&&"wdg_recent_played_games_menu"!=a&&(g.id=a,g=u.getElementById(a),g.className=
a+" "+g.className);"game_thumb"===c.ui_format&&Tooltip.create(".wdg_recent_played_games_menu .recent-game");d.getProperty("no_recent_games")?d.System.emit("recent.played.empty"):(d.System.emit("recent.played.filled"),window.setTimeout(n.trigger,500));n.handleImagesIn(g);B.track(g)},z=function(a,b,c){var f=a[0];f?h(f,function(G){a.shift();b[f]=G;z(a,b,c)}):c(b)};m=function(){if(!0!==c.track_only){var a=["client"];"backend"===c.storage_endpoint&&(a[1]="backend");z(a,{},function(a){d.Widget.refresh({app_list:JSON.stringify(a),
ui_format:c.ui_format,xhr:!0,lazyload_images:c.lazyload_images,lazyload_from_item:c.lazyload_from_item},{callback:H})})}};var A=e.once(m);h("client",function(a){var b=a.map(function(a){if(e.isObject(a)&&a.gid)return a.gid}).filter(function(a){return e.isString(a)}),d=a.filter(function(a){return e.isString(a)});a=a.length-b.length-d.length;if(0<b.length||0<a){var f=e.combine(d,b);p("client",f);"backend"===c.storage_endpoint&&h("backend",function(a){0===a.length&&(a=f,p("backend",a))})}});(function(a){"backend"===
a&&D(function(a){a||h("backend",function(a){a=a.map(function(a){e.isObject(a)&&a.gid&&(a=a.gid);return a}).filter(function(a){return e.isString(a)});0<a.length&&F(a)})})})(c.storage_endpoint);e.isEmpty(c.wait_on_js_event)&&m();n.until("visible",g,function(){d.System.emit("recent.played.visible")});d.System.init(function(a){var b=a&&a.data?a.data:{};switch(a.name){case "inlinegame.open":case "recent.played.games.update":y(void 0,b.applicationId||void 0,!1);break;case "game.sidepanel.open":"recent_played_games"!==
b.item||e.isEmpty(c.wait_on_js_event)||A();break;case c.wait_on_js_event:A()}})});
//# sourceMappingURL=wdg_recent_played_games_menu-MINIFIED-79353a4dfc9ad919a648144918776fdd.js.map
